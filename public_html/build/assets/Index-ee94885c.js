import{r as x,j as e,a as E,b as S}from"./app-7328f2b6.js";import{A as R}from"./AuthenticatedLayout-d9818f8f.js";import{E as F}from"./jspdf.es.min-5a272e11.js";import T from"./reporte_solicitudes-ba84644d.js";import I from"./reporte_documentos-7100c77b.js";import{f as l}from"./index-af05e076.js";import"./transition-2f2ce9ea.js";import"./Modal-c879149f.js";import"./typeof-7fd5df1e.js";function P({auth:m,tipo_solicitudes:w,clientes:N,estados:v}){const b=m.user.solicitudes.filter(t=>t.tipo_id>2),g=[];b.forEach(t=>{t.files&&t.files.length>0&&g.push(...t.files)});const[p,k]=x.useState(g),[h,D]=x.useState(b),[i,f]=x.useState(0),[s,d]=x.useState({inicio:0,fin:0,tipo:0,cliente:0,estado:0,fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString("en-US",{hour12:!0}),usuario:m.user.name});x.useEffect(()=>{console.log(s),C()},[s]);const C=()=>{const t=new Date(s.inicio+" 00:00:00"),r=new Date(s.fin+" 23:59:59"),o=b.filter(n=>{const c=new Date(n.created_at);return console.log(c,n.created_at),!(s.inicio&&c<t||s.fin&&c>r||s.tipo&&n.tipo_id!==s.tipo||s.cliente&&n.user.name!==s.cliente||s.estado&&n.status_id!==s.estado)}),a=g.filter(n=>{const c=new Date(n.created_at);return!(s.inicio&&c<t||s.fin&&c>r||s.cliente&&n.user.name!==s.cliente)});i==0?D(o):(k(a),console.log(a))},y=t=>{const r=new F("p","pt","a4");r.setFontSize(5);const o=document.createElement("div"),a=S(o),n={...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Innicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Finn"};document.body.appendChild(o),t==0?a.render(e.jsx(T,{solicitudes_f:h,datos:n})):t==1&&a.render(e.jsx(I,{documentos_f:p,datos:s}));const c=o.offsetWidth,j=590;console.log(c,j);const _=j/c;r.html(o,{x:5,y:5,html2canvas:{scale:_},callback:function(M){M.save("report.pdf"),a.unmount(),document.body.removeChild(o)}})},u=()=>{const t=[{ruta:"/reportes/generar/soli",nombre:"reporte_solicitudes.xlsx",datos:{...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Inicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Fin"},solicitudes_f:h},{ruta:"/reportes/generar/docu",nombre:"reporte_documentos.xlsx",datos:{...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Inicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Fin"},documentos_f:p}];axios.post(t[i].ruta,{data:t[i]},{responseType:"blob"}).then(r=>{console.log(r);const o=window.URL.createObjectURL(new Blob([r.data])),a=document.createElement("a");a.href=o,a.setAttribute("download",t[i].nombre),document.body.appendChild(a),a.click()}).catch(r=>{console.error("Error al descargar el archivo:",r)})};return e.jsx(R,{countNotificaciones:m.countNotificaciones,user:m.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Reportes"}),children:e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Reportes"}),e.jsxs("div",{className:"mx-10 mt-3",children:[e.jsxs("div",{className:"flex text-black ",children:[e.jsxs("button",{onClick:()=>f(0),className:` rounded-t-2xl cursor-pointer flex items-center gap-2 h-10 p-2 bg-gray-300  ${i==0?"bg-white ":""}  font-semibold text-base `,children:[e.jsx("img",{src:"/assets/svg/export2.svg",width:30,height:30,alt:"icon documento"}),"Solicitudes"]}),e.jsxs("button",{onClick:()=>f(1),className:`rounded-t-2xl cursor-pointer flex items-center gap-2 h-10 p-2 bg-gray-300 ${i==1?"bg-white ":""}  font-semibold text-base `,children:[e.jsx("img",{src:"/assets/svg/document2.svg",width:30,height:30,alt:"icon documento"}),"Documentos"]})]}),e.jsxs("div",{className:"rounded-tl-none mb-4 bg-white p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex gap-8 my-3",children:[e.jsxs("label",{className:" flex flex-col ",children:[e.jsx("span",{className:"font-semibold",children:"Fecha de inicio"}),e.jsx("input",{max:s.fin,className:"p-0 px-2 rounded-md w-52 h-8",type:"date",value:s.inicio,onChange:t=>d({...s,inicio:t.target.value})})]}),e.jsxs("label",{className:"flex flex-col ",children:[e.jsx("span",{className:"font-semibold",children:"Fecha de fin"}),e.jsx("input",{min:s.inicio,className:"p-0 px-2 rounded-md w-52 h-8",type:"date",value:s.fin,onChange:t=>d({...s,fin:t.target.value})})]}),e.jsxs("label",{className:"flex  flex-col",children:[e.jsx("span",{className:"font-semibold",children:"Cliente:"}),e.jsxs("select",{required:!0,value:s.cliente,onChange:t=>d({...s,cliente:t.target.value}),name:"cliente",id:"cliente",className:"p-0 px-2 pe-6 w-fit min-w-[13rem] rounded-md  h-8",children:[e.jsx("option",{value:"",select:!0,children:"Todos"}),N.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]})]}),i==0&&e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("label",{className:"flex  flex-col ",children:[e.jsx("span",{className:"font-semibold",children:" Tipo Solicitudes:"}),e.jsxs("select",{required:!0,value:s.tipo,onChange:t=>d({...s,tipo:parseInt(t.target.value)}),name:"tipo_id",id:"tipo_id",className:"p-0 px-2 w-fit rounded-md h-8",children:[e.jsx("option",{value:0,select:!0,children:"Todas"}),w.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]})]}),e.jsxs("label",{className:"flex  flex-col",children:[e.jsx("span",{className:"font-semibold",children:"Estados:"}),e.jsxs("select",{required:!0,value:s.estado,onChange:t=>d({...s,estado:parseInt(t.target.value)}),name:"estado",id:"estado",className:"p-0 px-2 pe-6 w-fit min-w-[13rem] rounded-md  h-8",children:[e.jsx("option",{value:"",select:!0,children:"Todos"}),v.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]})]})]})]}),i==0?e.jsx("div",{children:e.jsx("div",{id:"contenido",className:"",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsxs("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-white w-full px-3 py-2",children:e.jsxs("div",{className:" flex items-center gap-3 font-bold ",children:[e.jsx("span",{children:"Exportar"}),e.jsx("button",{className:"hover:scale-125",onClick:()=>y(i),children:e.jsx("img",{src:"/assets/svg/pdf.svg",width:30,height:30,alt:"icon documento"})}),e.jsx("button",{className:"hover:scale-125",onClick:()=>u(),children:e.jsx("img",{src:"/assets/svg/xlsx.svg",width:30,height:30,alt:"icon documento"})})]})}),e.jsxs("table",{className:"min-w-full leading-normal overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"# Solicitud"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"RNC"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"CORREO"})]})}),e.jsx("tbody",{children:h&&h.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.numero})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.tipo.nombre})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.rnc})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:l(new Date(t.created_at),"dd/MM/yyyy hh:mm:ss a")})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.status.nombre})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.email})})]},r))})]})]})})})}):e.jsx("div",{children:e.jsx("div",{id:"contenido",className:"",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsxs("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-white w-full px-3 py-2",children:e.jsxs("div",{className:" flex items-center gap-3 font-bold ",children:[e.jsx("span",{children:"Exportar"}),e.jsx("button",{className:"hover:scale-125",onClick:()=>y(i),children:e.jsx("img",{src:"/assets/svg/pdf.svg",width:30,height:30,alt:"icon documento"})}),e.jsx("button",{className:"hover:scale-125",onClick:()=>u(),children:e.jsx("img",{src:"/assets/svg/xlsx.svg",width:30,height:30,alt:"icon documento"})})]})}),e.jsxs("table",{className:"min-w-full leading-normal overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tipo Documento"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Usuario"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"})]})}),e.jsx("tbody",{children:p&&p.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-base font-medium",children:t.id}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.nombre})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.extencion})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.created_at&&l(new Date(t.created_at),"dd/MM/yyyy hh:mm:ss a")})})]},r))})]})]})})})})]})]})})}export{P as default};
